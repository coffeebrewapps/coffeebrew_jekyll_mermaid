<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="stylesheet" href="/assets/css/styles.css">
    <title>Home</title>
  </head>
  <body>
    <script src="/assets/js/main.js"></script>
    <nav id="top-nav" class="top-nav">
  <a>Current: 0.1.0</a>
  
    <a href="/" class="current">
      Home
    </a>
  
    <a href="/versions.html" >
      Versions
    </a>
  
  <a href="javascript:void(0);" class="icon" onclick="toggleMenu()">
    <i class="fa-solid fa-bars"></i>
  </a>
</nav>

    <div class="container">
      <div id="table-of-contents">
        <div class="versions">
          <div>
            Versions:
            <select id="select-version" onchange="selectVersion()">
              
                <option selected="selected" value="/versions/0.1.0.html">0.1.0</option>
              
            </select>
          </div>
        </div>
        <ul id="toc" class="toc">
<li class="toc-entry toc-h2"><a href="#installation">Installation</a></li>
<li class="toc-entry toc-h2"><a href="#configuration">Configuration</a>
<ul>
<li class="toc-entry toc-h3"><a href="#source-config">Source config</a></li>
<li class="toc-entry toc-h3"><a href="#theme-config">Theme config</a></li>
<li class="toc-entry toc-h3"><a href="#validation">Validation</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#layout">Layout</a></li>
<li class="toc-entry toc-h2"><a href="#contributing">Contributing</a></li>
<li class="toc-entry toc-h2"><a href="#development">Development</a>
<ul>
<li class="toc-entry toc-h3"><a href="#source-directory-structure">Source directory structure</a></li>
<li class="toc-entry toc-h3"><a href="#test-cases-directory-structure">Test cases directory structure</a></li>
<li class="toc-entry toc-h3"><a href="#writing-test-cases">Writing test cases</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#license">License</a></li>
</ul>
      </div>
      <div id="content">
        <h1 id="jekyll-mermaid-plugin">Jekyll Mermaid Plugin</h1>

<p>A Jekyll plugin to render Mermaid diagrams and flowcharts with options to configure themes.</p>

<p><a href="https://github.com/coffeebrewapps/coffeebrew_jekyll_mermaid/actions/workflows/ruby.yml"><img src="https://github.com/coffeebrewapps/coffeebrew_jekyll_mermaid/actions/workflows/ruby.yml/badge.svg" alt="Continuous Integration" /></a> <a href="https://badge.fury.io/rb/coffeebrew_jekyll_mermaid"><img src="https://badge.fury.io/rb/coffeebrew_jekyll_mermaid.svg" alt="Gem Version" /></a></p>

<h2 id="installation">Installation</h2>

<p>Add this line to your site’s Gemfile:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gem</span> <span class="s1">'coffeebrew_jekyll_mermaid'</span>
</code></pre></div></div>

<p>And then add this line to your site’s <code class="language-plaintext highlighter-rouge">_config.yml</code>:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">plugins</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">coffeebrew_jekyll_mermaid</span>
</code></pre></div></div>

<p>To use render Mermaid diagrams and flowcharts in your page, use the <code class="language-plaintext highlighter-rouge">mermaid</code> Liquid tag like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
{% mermaid %}
graph TD;
    A--&gt;B;
    A--&gt;C;
    B--&gt;D;
    C--&gt;D;
{% endmermaid %}

</code></pre></div></div>

<p>The plugin will automatically inject the <code class="language-plaintext highlighter-rouge">mermaid.js</code> source so that the graph will be rendered accordingly.</p>

<h2 id="configuration">Configuration</h2>

<p>By default, the plugin uses this configuration.</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">coffeebrew_jekyll_mermaid</span><span class="pi">:</span>
  <span class="na">src</span><span class="pi">:</span> <span class="s2">"</span><span class="s">https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs"</span>
  <span class="na">theme</span><span class="pi">:</span>
    <span class="na">base</span><span class="pi">:</span> <span class="s2">"</span><span class="s">base"</span>
    <span class="na">variables</span><span class="pi">:</span>
      <span class="na">primaryColor</span><span class="pi">:</span> <span class="s2">"</span><span class="s">#f4e3d7"</span>
      <span class="na">primaryTextColor</span><span class="pi">:</span> <span class="s2">"</span><span class="s">#502d16"</span>
      <span class="na">primaryBorderColor</span><span class="pi">:</span> <span class="s2">"</span><span class="s">#784421"</span>
      <span class="na">lineColor</span><span class="pi">:</span> <span class="s2">"</span><span class="s">#784421"</span>
      <span class="na">secondaryColor</span><span class="pi">:</span> <span class="s2">"</span><span class="s">#a05a2c"</span>
      <span class="na">tertiaryColor</span><span class="pi">:</span> <span class="s2">"</span><span class="s">#c87137"</span>
</code></pre></div></div>

<p>You can override any of the default configuration values above.</p>

<h3 id="source-config">Source config</h3>

<p>This tells the plugin where to load the <code class="language-plaintext highlighter-rouge">mermaid.js</code> from. It can be a remote source like a CDN, or local file path.
Do take note that for local path, it should start with the <code class="language-plaintext highlighter-rouge">/</code> path, this tells Jekyll to load from the site’s base
url.</p>

<p>For example:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">coffeebrew_jekyll_mermaid</span><span class="pi">:</span>
  <span class="na">src</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/assets/js/mermaid/mermaid.js"</span>
</code></pre></div></div>

<p>And suppose the base url is <code class="language-plaintext highlighter-rouge">example.com</code>, then Jekyll will try to load the file from
<code class="language-plaintext highlighter-rouge">example.com/assets/js/mermaid/mermaid.js</code>.</p>

<p>If you load from local, make sure you have all the sub-modules included under the local directory, eg.</p>

<ul>
  <li>commonDb-<hash>.js</hash></li>
  <li>mermaidAPI-<hash>.js</hash></li>
</ul>

<p>Please check the <a href="https://www.jsdelivr.com/package/npm/mermaid" target="_blank">Mermaid CDN</a> for all the
files that should be included.</p>

<h3 id="theme-config">Theme config</h3>

<p>This tells the plugin what color scheme to use for the diagrams and flowcharts.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">base</code>: specifies the base theme from Mermaid</li>
  <li><code class="language-plaintext highlighter-rouge">variables</code>: overrides the colors from the base theme from Mermaid</li>
</ul>

<p>Please note that the variable keys should be camelCase. Refer to
<a href="https://mermaid.js.org/config/theming.html#customizing-themes-with-themevariables">Mermaid documentation</a>
for configurable variables.</p>

<h3 id="validation">Validation</h3>

<p>Because the number of theme variables are extensive, it is not feasible for the plugin to perform validation. There’s
currently no built in validation for the configuration.</p>

<h2 id="layout">Layout</h2>

<p>The plugin does not provide a default layout because it only supports a custom Liquid tag. However, if you use the
<code class="language-plaintext highlighter-rouge">mermaid</code> tag, the rendered page should look something like this (using the example at the start of the doc):</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"module"</span><span class="nt">&gt;</span>
  <span class="k">import</span> <span class="nx">mermaid</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs</span><span class="dl">'</span><span class="p">;</span>
  <span class="nx">mermaid</span><span class="p">.</span><span class="nf">initialize</span><span class="p">({</span>
    <span class="na">startOnLoad</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;pre</span> <span class="na">class=</span><span class="s">"mermaid"</span><span class="nt">&gt;</span>
%%{
  init: {
    'theme': 'base',
    'themeVariables': {
      "primaryColor": "#f4e3d7",
      "primaryTextColor": "#502d16",
      "primaryBorderColor": "#784421",
      "lineColor": "#784421",
      "secondaryColor": "#a05a2c",
      "tertiaryColor": "#c87137"
    }
  }
}%%
graph TD;
    A--<span class="ni">&amp;gt;</span>B;
    A--<span class="ni">&amp;gt;</span>C;
    B--<span class="ni">&amp;gt;</span>D;
    C--<span class="ni">&amp;gt;</span>D;
<span class="nt">&lt;/pre&gt;</span>

</code></pre></div></div>

<h2 id="contributing">Contributing</h2>

<p>Contribution to the gem is very much welcome!</p>

<ol>
  <li>Fork it (https://github.com/coffeebrewapps/coffeebrew_jekyll_mermaid/fork).</li>
  <li>Create your feature branch (<code class="language-plaintext highlighter-rouge">git checkout -b my-new-feature</code>).</li>
  <li>Make sure you have setup the repo correctly so that you can run RSpec and Rubocop on your changes. Read more under the <a href="#development">Development</a> section.</li>
  <li>Commit your changes (<code class="language-plaintext highlighter-rouge">git commit -am 'Add some feature'</code>).</li>
  <li>If you have added something that is worth mentioning in the README, please also update the README.md accordingly and commit the changes.</li>
  <li>Push to the branch (<code class="language-plaintext highlighter-rouge">git push origin my-new-feature</code>).</li>
  <li>Create a new Pull Request.</li>
</ol>

<p>The repo owner will try to respond to a new PR as soon as possible.</p>

<h2 id="development">Development</h2>

<p>We want to provide a robust gem as much as possible for the users, so writing test cases will be required for any new
feature.</p>

<p>If you are contributing to the gem, please make sure you have setup your development environment correctly so that
RSpec and Rubocop can run properly.</p>

<ol>
  <li>After forking the repo, go into the repo directory (<code class="language-plaintext highlighter-rouge">cd coffeebrew_jekyll_mermaid/</code>).</li>
  <li>Make sure you have the correct Ruby version installed. This gem requires Ruby &gt;= 2.7.0.</li>
  <li>Once you have the correct Ruby version, install the development dependencies (<code class="language-plaintext highlighter-rouge">bundle install</code>).</li>
  <li>To test that you have everything installed correctly, run the test cases (<code class="language-plaintext highlighter-rouge">bundle exec rspec</code>).</li>
  <li>You should see all test cases pass successfully.</li>
</ol>

<h3 id="source-directory-structure">Source directory structure</h3>

<p>All the gem logic lives in the <code class="language-plaintext highlighter-rouge">/lib</code> directory:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lib
├── coffeebrew_jekyll_mermaid
│   ├── block.rb
│   ├── config.yml
│   └── version.rb
└── coffeebrew_jekyll_mermaid.rb
</code></pre></div></div>

<p>The files that are currently in the repo:</p>

<table>
  <thead>
    <tr>
      <th>File</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">lib/coffeebrew_jekyll_mermaid/block.rb</code></td>
      <td>This is the custom Liquid block that injects the <code class="language-plaintext highlighter-rouge">mermaid.js</code> source and wraps the Mermaid syntax in a <code class="language-plaintext highlighter-rouge">&lt;pre&gt;</code> block.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">lib/coffeebrew_jekyll_mermaid/config.yml</code></td>
      <td>This contains the default configuration for the plugin to get the <code class="language-plaintext highlighter-rouge">mermaid.js</code> source and override theme variables.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">lib/coffeebrew_jekyll_mermaid/version.rb</code></td>
      <td>This contains the version number of the gem.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">lib/coffeebrew_jekyll_mermaid.rb</code></td>
      <td>This is the entry point of the gem, and it loads the dependencies.</td>
    </tr>
  </tbody>
</table>

<h3 id="test-cases-directory-structure">Test cases directory structure</h3>

<p>All the test cases and fixtures live in the <code class="language-plaintext highlighter-rouge">/spec</code> directory:</p>

<p>Note: Some files have been omitted for clarity.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spec
├── coffeebrew_jekyll_mermaid_spec.rb
├── dest
├── fixtures
│   ├── _config.yml
│   ├── _layouts
│   │   └── default.html
│   └── _posts
│       ├── 2021-03-12-test-post-1.md
│       ├── 2021-03-28-test-post-2.md
│       ├── 2021-05-03-test-post-3.md
│       └── 2021-05-03-test-post-4.md
├── scenarios
│   └── default
│       ├── _site
│       │   └── posts
│       │       ├── 2021-03-12-test-post-1.html
│       │       ├── 2021-03-28-test-post-2.html
│       │       ├── 2021-05-03-test-post-3.html
│       │       └── 2021-05-03-test-post-4.html
│       └── context.rb
└── spec_helper.rb
</code></pre></div></div>

<p>The files that are currently in the repo:</p>

<table>
  <thead>
    <tr>
      <th>File</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">spec/coffeebrew_jekyll_mermaid_spec.rb</code></td>
      <td>This is the main RSpec file to be executed. It contains all the contexts of various scenarios.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">spec/dest/</code></td>
      <td>This directory is where generated files are located. It will be deleted immediately after each context is executed.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">spec/fixtures/</code></td>
      <td>This directory follows the Jekyll site source structure and contains the minimal files required to generate the example pages.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">spec/fixtures/_posts</code></td>
      <td>This directory contains the test posts, you can add more to it to test your new feature.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">spec/scenarios/</code></td>
      <td>This directory contains the expected files of various test scenarios.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">spec/scenarios/&lt;scenario&gt;/</code></td>
      <td>This is the scenario name.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">spec/scenarios/&lt;scenario&gt;/_site/</code></td>
      <td>This directory contains the expected example pages.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">spec/scenarios/&lt;scenario&gt;/_config.yml</code></td>
      <td>This contains the config overrides for the scenario.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">spec/scenarios/&lt;scenario&gt;/context.rb</code></td>
      <td>This is the file that sets up the context for the test case.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">spec/spec_helper.rb</code></td>
      <td>This contains RSpec configuration and certain convenience methods for the main RSpec file.</td>
    </tr>
  </tbody>
</table>

<h3 id="writing-test-cases">Writing test cases</h3>

<p>There is a certain convention to follow when writing new test scenarios. The recommendation is to use the rake tasks
provided in the gem to generate the scenario files.</p>

<p>For success scenarios, run:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bundle <span class="nb">exec </span>rake coffeebrew:jekyll:mermaid:test:create_success[test_scenario]
</code></pre></div></div>

<p>This will generate a placeholder file and directory:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spec
├── coffeebrew_jekyll_mermaid_spec.rb
├── scenarios
│   └── test_scenario
│       ├── _site
│       ├── _config.yml
│       └── context.rb
└── spec_helper.rb
</code></pre></div></div>

<p>Where the <code class="language-plaintext highlighter-rouge">context.rb</code> file will be pre-populated:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># frozen_string_literal: true</span>

<span class="no">CONTEXT_TEST_SCENARIO</span> <span class="o">=</span> <span class="s2">"when using test_scenario config"</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">shared_context</span> <span class="no">CONTEXT_TEST_SCENARIO</span> <span class="k">do</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:scenario</span><span class="p">)</span> <span class="p">{</span> <span class="s2">"test_scenario"</span> <span class="p">}</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:overrides</span><span class="p">)</span> <span class="p">{}</span> <span class="c1"># TODO: remove if unused</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:generated_files</span><span class="p">)</span> <span class="p">{}</span> <span class="c1"># TODO: remove if unused</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:expected_files</span><span class="p">)</span> <span class="k">do</span>
    <span class="p">[</span>
    <span class="p">]</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>If you do write other test cases that are not asserting the generated files like above, you can initiate your
convention. The repo owner will evaluate the PR and accept the convention if it fits the repo existing convention, or
will recommend an alternative if it doesn’t.</p>

<h2 id="license">License</h2>

<p>See the <a href="/license.html">LICENSE</a> file.</p>

      </div>
    </div>
    <a class="back-to-top" href="#">
      <i class="fa-solid fa-angle-up"></i>
    </a>
    <footer class="site-footer">
      <div class="copyright">
        <span>Coffee Brew Apps © 2023</span>
      </div>
      <div class="socials">
        
        <a href="https://github.com/coffeebrewapps/coffeebrew_jekyll_mermaid" target="_blank"><i class="fa-brands fa-github"></i></a>
        
        <a href="https://www.linkedin.com/company/coffeebrewapps/" target="_blank"><i class="fa-brands fa-linkedin"></i></a>
        
        <a href="mailto:coffeebrewapps+hi@gmail.com" target="_blank"><i class="fa-solid fa-envelope"></i></a>
        
      </div>
      <div class="powered-by">
        <div class="link">Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a></div>
        <div class="divider">|</div>
        <div class="link">Theme by <a href="https://www.coffeebrewapps.com/coffeebrew_jekyll_docs/" target="_blank">Coffee Brew Apps</a></div>
        <div class="divider">|</div>
        <div class="link">Hosted by <a href="https://github.com" target="_blank">Github Pages</a></div>
        <div class="divider">|</div>
        <div class="link">Under <a href="/license.html" target="_blank">MIT License</a></div>
      </div>
    </footer>
  </body>
</html>
